<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet author="jjablonski" id="entryrelation_foreignkeys-1">
        <dropForeignKeyConstraint baseTableName="entryrelation" constraintName="FK_EntryRelation_Entry"/>
        <dropForeignKeyConstraint baseTableName="entryrelation" constraintName="FK_EntryRelation_Entry_02"/>
    </changeSet>
    <changeSet author="jjablonski" id="entryrelation_foreignkeys-2">
        <modifyDataType
                columnName="srcId"
                newDataType="VARCHAR(180)"
                tableName="entryrelation"/>
        <modifyDataType
                columnName="destId"
                newDataType="VARCHAR(180)"
                tableName="entryrelation"/>
    </changeSet>
    <changeSet author="jjablonski" id="entryrelation_foreignkeys-5">
        <sql>UPDATE `entryrelation`
            SET srcId = (SELECT entry.code FROM entry WHERE entry.id = srcId),
            destId = (SELECT entry.code FROM entry WHERE entry.id = destId)
        </sql>
    </changeSet>
</databaseChangeLog>
